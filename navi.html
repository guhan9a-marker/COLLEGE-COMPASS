<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Campus Navigation â€” St. Joseph's College of Engineering</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Leaflet & Routing Machine CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
  
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #111;
      color: #fff;
    }
    header {
      text-align: center;
      padding: 14px;
      background: #212121;
      font-size: 1.4em;
      color: #28c7fa;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
    }
    #map {
      position: absolute;
      top: 110px;
      bottom: 0;
      width: 100%;
    }
    .controls {
      position: absolute;
      top: 55px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(30, 32, 43, 0.97);
      padding: 12px 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.4);
      z-index: 10;
    }
    select, button {
      background: #1b2330;
      color: #28c7fa;
      border: 2px solid #28c7fa;
      border-radius: 8px;
      padding: 8px 10px;
      font-size: 1em;
      margin: 4px;
    }
    button:hover {
      background: #28c7fa;
      color: #1b2330;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <header>ðŸ§­ Campus Navigation â€” St. Josephâ€™s College of Engineering</header>

  <div class="controls">
    <label for="destinationSelect"><b>Select Destination:</b></label>
    <select id="destinationSelect">
      <option value="">-- Choose Location --</option>
      <option value="12.86840,80.21597">Engineering Auditorium</option>
      <option value="12.86972,80.21508">Library</option>
      <option value="12.86961,80.21514">MGR Statue</option>
      <option value="12.87061,80.21594">1st Year Physics Lab</option>
      <option value="12.87064,80.21597">1st Year Chemistry Lab</option>
      <option value="12.87078,80.21636">Examination Block</option>
      <option value="12.86986,80.21619">1st Year Computer Science Lab</option>
      <option value="12.87028,80.21586">Mechanical Lab</option>
      <option value="12.86950,80.21672">Administration Office Entrance</option>
      <option value="12.86953,80.21698">Innovation Hackathon Centre</option>
      <option value="12.87081,80.21688">Department of Placement Block</option>
      <option value="12.87119,80.21586">Bus Bay Entrance</option>
      <option value="12.87139,80.21647">Bus Garage</option>
      <option value="12.87050,80.21714">1st Entrance of PEP Centre</option>
      <option value="12.86972,80.21699">2nd Entrance of PEP Centre</option>
      <option value="12.86775,80.21511">Mens Hostel</option>
      <option value="12.87133,80.21400">Girls Hostel</option>
      <option value="12.87147,80.21558">Chapel</option>
      <option value="12.86781,80.21322">St. Josephâ€™s Football Ground</option>
      <option value="12.86894,80.21638">Block 1</option>
      <option value="12.86900,80.21613">Block 2</option>
      <option value="12.86906,80.21601">Block 3</option>
      <option value="12.86912,80.21572">Block 4</option>
      <option value="12.86917,80.21556">Block 5</option>
      <option value="12.86828,80.21648">Department Blocks Road (2nd Year)</option>
    </select>
    <button onclick="startNavigation()">Start Navigation</button>
  </div>

  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>

  <script>
    // Initialize the map centered on the college entrance
    const map = L.map('map').setView([12.8702, 80.2161], 17);

    // Add OpenStreetMap tiles (no API key needed)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    let routingControl;

    function startNavigation() {
      const selected = document.getElementById('destinationSelect').value;
      if (!selected) {
        alert("Please select a destination.");
        return;
      }

      const [destLat, destLng] = selected.split(',').map(Number);

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((pos) => {
          const userLat = pos.coords.latitude;
          const userLng = pos.coords.longitude;

          // Remove old route if exists
          if (routingControl) {
            map.removeControl(routingControl);
          }

          // Create route
          routingControl = L.Routing.control({
            waypoints: [
              L.latLng(userLat, userLng),
              L.latLng(destLat, destLng)
            ],
            routeWhileDragging: false,
            showAlternatives: false,
            lineOptions: {
              styles: [{ color: '#28c7fa', weight: 6 }]
            },
            createMarker: function(i, waypoint, n) {
              return L.marker(waypoint.latLng, {
                icon: L.icon({
                  iconUrl: i === 0 
                    ? 'https://cdn-icons-png.flaticon.com/512/64/64113.png' // user marker
                    : 'https://cdn-icons-png.flaticon.com/512/684/684908.png', // destination marker
                  iconSize: [32, 32]
                })
              });
            }
          }).addTo(map);

        }, () => {
          alert("Unable to access your location.");
        });
      } else {
        alert("Geolocation is not supported by your browser.");
      }
    }
  </script>
</body>
</html>
